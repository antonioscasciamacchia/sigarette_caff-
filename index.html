<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contatore Sigarette & Caff√®</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Stile per la scrollbar per un aspetto pi√π pulito */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md mx-auto bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 space-y-6">
        
        <!-- Intestazione -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-cyan-400">Contatore Sigarette & Caff√®</h1>
            <p class="text-gray-400 mt-2">Tieni traccia di prestiti e omaggi.</p>
        </div>

        <!-- Riepilogo Saldo -->
        <div class="bg-gray-900 rounded-xl p-6 text-center space-y-4">
            <div>
                <p class="text-sm text-gray-400 uppercase font-semibold">Saldo Attuale</p>
                <p id="saldo-attuale" class="text-5xl font-bold text-white transition-colors duration-300">‚Ç¨ 0.00</p>
            </div>
            <div class="flex justify-around text-center border-t border-gray-700 pt-4">
                <div>
                    <p class="text-xs text-gray-400 uppercase font-semibold">Totale Sigarette</p>
                    <p id="conteggio-sigarette" class="text-2xl font-bold text-white">0</p>
                </div>
                <div>
                    <p class="text-xs text-gray-400 uppercase font-semibold">Totale Caff√®</p>
                    <p id="conteggio-caffe" class="text-2xl font-bold text-white">0</p>
                </div>
            </div>
        </div>

        <!-- Pulsanti di Azione -->
        <div class="grid grid-cols-2 gap-4">
            <button id="aggiungi-sigaretta" class="w-full bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-opacity-75">
                +1 Sigaretta üö¨
            </button>
            <button id="aggiungi-caffe" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-opacity-75">
                +1 Caff√® ‚òï
            </button>
        </div>
         <button id="reset-contatore" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-75">
                Resetta
        </button>

        <!-- Cronologia -->
        <div class="space-y-4">
            <h2 class="text-xl font-semibold border-b border-gray-700 pb-2">Cronologia</h2>
            <div id="elenco-transazioni" class="max-h-60 overflow-y-auto space-y-3 pr-2">
                <!-- Le transazioni verranno inserite qui da JavaScript -->
                 <p id="nessuna-transazione" class="text-gray-500 text-center py-4">Nessuna operazione registrata.</p>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const COSTO_SIGARETTA = 0.30;
            const VALORE_CAFFE = 0.50;

            // Elementi del DOM
            const saldoDisplay = document.getElementById('saldo-attuale');
            const conteggioSigaretteDisplay = document.getElementById('conteggio-sigarette');
            const conteggioCaffeDisplay = document.getElementById('conteggio-caffe');
            const elencoDisplay = document.getElementById('elenco-transazioni');
            const aggiungiSigarettaBtn = document.getElementById('aggiungi-sigaretta');
            const aggiungiCaffeBtn = document.getElementById('aggiungi-caffe');
            const resetBtn = document.getElementById('reset-contatore');

            // Carica i dati dal localStorage o inizializza un array vuoto
            let transazioni = JSON.parse(localStorage.getItem('transazioniContatore')) || [];

            // Funzione per aggiornare la visualizzazione
            const aggiornaUI = () => {
                let totaleSigarette = 0;
                let totaleCaffe = 0;

                transazioni.forEach(t => {
                    if (t.tipo === 'sigaretta') totaleSigarette++;
                    if (t.tipo === 'caffe') totaleCaffe++;
                });

                const costoTotaleSigarette = totaleSigarette * COSTO_SIGARETTA;
                const valoreTotaleCaffe = totaleCaffe * VALORE_CAFFE;
                const saldo = costoTotaleSigarette - valoreTotaleCaffe;

                // Aggiorna i display
                conteggioSigaretteDisplay.textContent = totaleSigarette;
                conteggioCaffeDisplay.textContent = totaleCaffe;
                saldoDisplay.textContent = `‚Ç¨ ${saldo.toFixed(2)}`;

                // Cambia colore del saldo
                saldoDisplay.classList.remove('text-emerald-400', 'text-red-500', 'text-white');
                if (saldo > 0) {
                    saldoDisplay.classList.add('text-emerald-400'); // Il collega deve soldi
                } else if (saldo < 0) {
                    saldoDisplay.classList.add('text-red-500'); // Tu devi soldi
                } else {
                    saldoDisplay.classList.add('text-white');
                }


                // Pulisci l'elenco precedente
                elencoDisplay.innerHTML = '';

                // Mostra/nascondi il messaggio di default
                if (transazioni.length === 0) {
                    const p = document.createElement('p');
                    p.id = 'nessuna-transazione';
                    p.className = 'text-gray-500 text-center py-4';
                    p.textContent = 'Nessuna operazione registrata.';
                    elencoDisplay.appendChild(p);
                } else {
                     // Popola l'elenco in ordine decrescente (dal pi√π recente)
                    transazioni.slice().reverse().forEach(t => {
                        const dataTransazione = new Date(t.timestamp);
                        const dataFormattata = dataTransazione.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' });
                        const oraFormattata = dataTransazione.toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' });

                        const icona = t.tipo === 'sigaretta' ? 'üö¨' : '‚òï';
                        const testo = `${icona} ${dataFormattata} - ${oraFormattata}`;
                        
                        const elementoLista = document.createElement('div');
                        elementoLista.className = 'bg-gray-700 p-3 rounded-lg flex justify-between items-center animate-fade-in';
                        
                        const spanTesto = document.createElement('span');
                        spanTesto.className = 'text-gray-300';
                        spanTesto.textContent = testo;
                        
                        elementoLista.appendChild(spanTesto);
                        elencoDisplay.appendChild(elementoLista);
                    });
                }
            };

            // Funzione per salvare i dati e aggiornare la UI
            const salvaEAggiorna = () => {
                localStorage.setItem('transazioniContatore', JSON.stringify(transazioni));
                aggiornaUI();
            };

            // Event Listeners
            aggiungiSigarettaBtn.addEventListener('click', () => {
                transazioni.push({ tipo: 'sigaretta', timestamp: new Date().toISOString() });
                salvaEAggiorna();
            });

            aggiungiCaffeBtn.addEventListener('click', () => {
                transazioni.push({ tipo: 'caffe', timestamp: new Date().toISOString() });
                salvaEAggiorna();
            });

            resetBtn.addEventListener('click', () => {
                transazioni = [];
                salvaEAggiorna();
            });

            // Aggiorna la UI al caricamento della pagina
            aggiornaUI();
        });

        // Aggiungi un piccolo stile per l'animazione di entrata
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes fade-in {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fade-in 0.3s ease-out forwards;
            }
        `;
        document.head.appendChild(style);
    </script>

</body>
</html>

