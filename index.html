<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contatore Sigarette & Caff√®</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Stile per la scrollbar per un aspetto pi√π pulito */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a202c; /* Colore pi√π scuro per il track */
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md mx-auto bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 space-y-6">
        
        <!-- Intestazione -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-cyan-400">Contatore Sigarette & Caff√®</h1>
            <p class="text-gray-400 mt-2">Tieni traccia di prestiti e omaggi.</p>
        </div>

        <!-- Riepilogo Saldo -->
        <div class="bg-gray-900 rounded-xl p-6 text-center space-y-4">
            <div>
                <p class="text-sm text-gray-400 uppercase font-semibold">Saldo Attuale</p>
                <p id="saldo-attuale" class="text-5xl font-bold text-white transition-colors duration-300">‚Ç¨ 0.00</p>
            </div>
            <div class="flex justify-around text-center border-t border-gray-700 pt-4">
                <div>
                    <p class="text-xs text-gray-400 uppercase font-semibold">Totale Sigarette</p>
                    <p id="conteggio-sigarette" class="text-2xl font-bold text-white">0</p>
                </div>
                <div>
                    <p class="text-xs text-gray-400 uppercase font-semibold">Totale Caff√®</p>
                    <p id="conteggio-caffe" class="text-2xl font-bold text-white">0</p>
                </div>
            </div>
        </div>

        <!-- Pulsanti di Azione -->
        <div class="grid grid-cols-2 gap-4">
            <button id="aggiungi-sigaretta" class="w-full bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-opacity-75">
                +1 Sigaretta üö¨
            </button>
            <button id="aggiungi-caffe" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-opacity-75">
                +1 Caff√® ‚òï
            </button>
        </div>
         <button id="reset-contatore" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-75">
                Resetta
        </button>

        <!-- Cronologie Separate -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6">
            <!-- Elenco Sigarette -->
            <div class="space-y-2">
                <h2 class="text-lg font-semibold border-b border-gray-700 pb-1 text-center">Sigarette Prestate</h2>
                <div id="elenco-sigarette" class="h-48 overflow-y-auto space-y-2 p-2 bg-gray-900 rounded-lg">
                    <!-- Contenuto generato da JS -->
                </div>
            </div>
            <!-- Elenco Caff√® -->
            <div class="space-y-2">
                <h2 class="text-lg font-semibold border-b border-gray-700 pb-1 text-center">Caff√® Offerti</h2>
                <div id="elenco-caffe" class="h-48 overflow-y-auto space-y-2 p-2 bg-gray-900 rounded-lg">
                    <!-- Contenuto generato da JS -->
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const COSTO_SIGARETTA = 0.30;
            const VALORE_CAFFE = 0.50;

            // Elementi del DOM
            const saldoDisplay = document.getElementById('saldo-attuale');
            const conteggioSigaretteDisplay = document.getElementById('conteggio-sigarette');
            const conteggioCaffeDisplay = document.getElementById('conteggio-caffe');
            const elencoSigaretteDisplay = document.getElementById('elenco-sigarette');
            const elencoCaffeDisplay = document.getElementById('elenco-caffe');
            const aggiungiSigarettaBtn = document.getElementById('aggiungi-sigaretta');
            const aggiungiCaffeBtn = document.getElementById('aggiungi-caffe');
            const resetBtn = document.getElementById('reset-contatore');

            // Carica i dati dal localStorage o inizializza un array vuoto
            let transazioni = JSON.parse(localStorage.getItem('transazioniContatore')) || [];

            // Funzione per creare un elemento della lista
            const creaElementoLista = (transazione) => {
                const dataTransazione = new Date(transazione.timestamp);
                const dataFormattata = dataTransazione.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' });
                const oraFormattata = dataTransazione.toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' });

                const testo = `${dataFormattata} - ${oraFormattata}`;
                
                const elementoLista = document.createElement('div');
                elementoLista.className = 'bg-gray-700 p-2 rounded-lg text-center animate-fade-in';
                
                const spanTesto = document.createElement('span');
                spanTesto.className = 'text-gray-300 text-sm';
                spanTesto.textContent = testo;
                
                elementoLista.appendChild(spanTesto);
                return elementoLista;
            };

            // Funzione per aggiornare la visualizzazione
            const aggiornaUI = () => {
                const sigarette = transazioni.filter(t => t.tipo === 'sigaretta');
                const caffe = transazioni.filter(t => t.tipo === 'caffe');

                const costoTotaleSigarette = sigarette.length * COSTO_SIGARETTA;
                const valoreTotaleCaffe = caffe.length * VALORE_CAFFE;
                const saldo = costoTotaleSigarette - valoreTotaleCaffe;

                // Aggiorna i display principali
                conteggioSigaretteDisplay.textContent = sigarette.length;
                conteggioCaffeDisplay.textContent = caffe.length;
                saldoDisplay.textContent = `‚Ç¨ ${saldo.toFixed(2)}`;

                // Cambia colore del saldo
                saldoDisplay.classList.remove('text-emerald-400', 'text-red-500', 'text-white');
                if (saldo > 0) {
                    saldoDisplay.classList.add('text-emerald-400'); // Il collega deve soldi
                } else if (saldo < 0) {
                    saldoDisplay.classList.add('text-red-500'); // Tu devi soldi
                } else {
                    saldoDisplay.classList.add('text-white');
                }

                // Pulisci e popola la lista delle sigarette
                elencoSigaretteDisplay.innerHTML = '';
                elencoSigaretteDisplay.classList.remove('flex', 'items-center', 'justify-center');
                if (sigarette.length === 0) {
                    elencoSigaretteDisplay.classList.add('flex', 'items-center', 'justify-center');
                    elencoSigaretteDisplay.innerHTML = '<p class="text-gray-500 text-center text-sm">Nessuna sigaretta.</p>';
                } else {
                    sigarette.slice().reverse().forEach(t => elencoSigaretteDisplay.appendChild(creaElementoLista(t)));
                }

                // Pulisci e popola la lista dei caff√®
                elencoCaffeDisplay.innerHTML = '';
                elencoCaffeDisplay.classList.remove('flex', 'items-center', 'justify-center');
                 if (caffe.length === 0) {
                    elencoCaffeDisplay.classList.add('flex', 'items-center', 'justify-center');
                    elencoCaffeDisplay.innerHTML = '<p class="text-gray-500 text-center text-sm">Nessun caff√®.</p>';
                } else {
                    caffe.slice().reverse().forEach(t => elencoCaffeDisplay.appendChild(creaElementoLista(t)));
                }
            };

            // Funzione per salvare i dati e aggiornare la UI
            const salvaEAggiorna = () => {
                localStorage.setItem('transazioniContatore', JSON.stringify(transazioni));
                aggiornaUI();
            };

            // Event Listeners
            aggiungiSigarettaBtn.addEventListener('click', () => {
                transazioni.push({ tipo: 'sigaretta', timestamp: new Date().toISOString() });
                salvaEAggiorna();
            });

            aggiungiCaffeBtn.addEventListener('click', () => {
                transazioni.push({ tipo: 'caffe', timestamp: new Date().toISOString() });
                salvaEAggiorna();
            });

            resetBtn.addEventListener('click', () => {
                transazioni = [];
                salvaEAggiorna();
            });

            // Aggiorna la UI al caricamento della pagina
            aggiornaUI();
        });

        // Aggiungi un piccolo stile per l'animazione di entrata
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes fade-in {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .animate-fade-in {
                animation: fade-in 0.3s ease-out forwards;
            }
        `;
        document.head.appendChild(style);
    </script>

</body>
</html>

